#!/usr/bin/env ruby

require "rubygems"
require "json"

# set up loadpath
here = File.dirname(__FILE__)
SPAWN_CONTROL_ROOT = File.expand_path("#{here}/..")
$LOAD_PATH.unshift("#{SPAWN_CONTROL_ROOT}/lib")

require "spawn_control"

string = File.read("spawn_control.json")
configuration = JSON.parse(string, :symbolize_names => true)
spawner = SpawnControl.new(configuration)

trap("INT") do
  exit
end

if ARGV.first == "console"
  require "spawn_control/console"
  spawner.start
  spawner.console
else
  spawner.start
end


